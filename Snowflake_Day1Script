USE ROLE SYSADMIN;

CREATE OR REPLACE WAREHOUSE INTERVIEW_WH WITH WAREHOUSE_SIZE = 'XSMALL' 
WAREHOUSE_TYPE = 'STANDARD' AUTO_SUSPEND = 300 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 1 SCALING_POLICY = 'STANDARD' COMMENT = 'Northwoods Airline Warehouse';

USE WAREHOUSE INTERVIEW_WH;

CREATE OR REPLACE DATABASE USER_ANBALAGAN
COMMENT = 'Database for Airline Project';

USE DATABASE USER_ANBALAGAN;

CREATE OR REPLACE SCHEMA NORTHWOODS_TABLES
COMMENT = 'Tables to store data from Northwoods Airlines';
    
USE SCHEMA USER_ANBALAGAN.NORTHWOODS_TABLES;

CREATE TABLE IF NOT EXISTS  NORTHWOODS_TABLES.AIRLINE (AR_CODE CHAR(2) NOT NULL , AR_NAME VARCHAR(100) NOT NULL);


CREATE TABLE IF NOT EXISTS  NORTHWOODS_TABLES.AIRPORT (AIRPORT_CODE CHAR(3) NOT NULL, AIRPORT_NAME VARCHAR(100),CITY VARCHAR(50), STATE CHAR(2) , COUNTRY CHAR(3), 
LATITUDE FLOAT , LONGITUDE FLOAT);

CREATE OR REPLACE SEQUENCE DT_SEQ start = 1 increment = 1;

CREATE TABLE IF NOT EXISTS  NORTHWOODS_TABLES.DATE_PART (DT_PKEY INT DEFAULT DT_SEQ.NEXTVAL, DT_YEAR INT,DT_MNTH INT,DT_DAY INT, DT_DAY_OF_WEEK INT )
                                                        
